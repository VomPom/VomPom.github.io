{"data":{"index":1,"total":1,"posts":[{"title":"如何构建一个好用的SDK","slug":"如何构建一个好用的SDK","date":"2026-02-04T12:53:23.000Z","updated":"2026-02-09T11:48:13.026Z","comments":true,"url":"2026/02/04/如何构建一个好用的SDK/","excerpt":"<p>如何去设计一个好用的SDK，自己做了很久的SDK，实际上并没有过多去思考过这个问题。最近对起总结一下，在回答这个问题之前，我们可以自己思考一下：对于接入者，怎样才算是一个好的SDK？对我自己而言，如果我要去接入一个SDK的话，可能会去考虑分别针对几个阶段：</p>\n<p><strong>接入前：</strong> 有清晰的文档能告诉我这个SDK 的环境要求，比如 minSdkVersion compileSdkVersion 这些硬性配置，明确列出<strong>所有直接 / 间接依赖的第三方库及版本</strong>，以及包大小、申请权限等。</p>\n<p><strong>接入中：</strong>接入需要足够简单，在 dependencies 中一行搞定；如果有初始化操作也尽量简洁，一行搞定；对应 SDK 调用 ，提供一个单例类或者某个接口，在这个类/接口里面能够看到最核心的 Api；使用的接口对各种异常处理有足够多的错误提示信息；针对输出日志能够有配置开关等。</p>\n<p><strong>接入后：</strong> SDK 由于功能需要更新，需提供详尽的 CHANGELOG，接入者只用更新版本号；</p>\n<p>上面是站在接入者的角度去考虑的，作为SDK的开发者则应该遵循以下的规则。</p>\n<h2 id=\"先前原则\"><a href=\"#先前原则\" class=\"headerlink\" title=\"先前原则\"></a>先前原则</h2><p><strong>核心原则：以接入方体验为中心</strong></p>\n<p>在开发一个SDK的时候，把接入者当作“小白”，不寄希望于他能点进SDK内部，去了解内部的实现；把接入者视作“懒人”，他不想做太多事，他赖得看你代码里面的各种注释，只想看一份接入文档就搞定所有事情。</p>\n<p><strong>最小化原则：只暴露必要的内容</strong></p>\n<p>对外仅暴露<strong>核心入口类 + 必要数据类 + 统一结果类</strong>，内部工具类、中间逻辑、私有方法全部标记为<code>private</code>（Java）/<code>internal</code>（Kotlin），杜绝接入方依赖内部逻辑。</p>\n<p><strong>稳定性原则：避免崩溃，容错兜底</strong></p>\n<p>不要将你的SDK视为一个可以随时更新的应用程序，而应将其看作一旦上线就无法实时更新的后端服务。避免崩溃是第一前提，但不可能万无一失，会由于设备兼容性问题，没法在上线将所有情况全考虑到，那么需要SDK能够有兜底操作，比如某个开关能够关闭掉该功能，或者针对特定机型Android系统等进行屏蔽（需服务端配合）。</p>\n<h2 id=\"开发阶段\"><a href=\"#开发阶段\" class=\"headerlink\" title=\"开发阶段\"></a>开发阶段</h2><h3 id=\"详细的文档\"><a href=\"#详细的文档\" class=\"headerlink\" title=\"详细的文档\"></a>详细的文档</h3><p>接入需要清晰、详细的文档，了解如何充分发挥 SDK 的能力。一份全面的文档需要包含：</p>\n<ul>\n<li><p>SDK开发环境要求</p>\n</li>\n<li><p>SDK安装和配置的详细流程</p>\n</li>\n<li><p>核心 Api 使用的代码示例</p>\n</li>\n<li><p>有一个可进行索引的目录</p>\n</li>\n</ul>\n<h3 id=\"安装和初始化\"><a href=\"#安装和初始化\" class=\"headerlink\" title=\"安装和初始化\"></a>安装和初始化</h3><p>使用<strong>Maven Publish Plugin</strong>将 SDK 发布到 Maven 仓库，配置<code>groupId</code>/<code>artifactId</code>/<code>version</code>，确保接入方仅需一行<code>implementation</code>即可引入；</p>\n<p>避免在 AndroidManifest.xml 中配置冗余内容，如需一些动态配置，提供<strong>Gradle 插件自动注入</strong>这些能力，无需接入方手动修改。</p>\n<p>初始化的时候一行搞定，比如：<code>XxxSdk.Builder().appKey(&quot;your_app_key&quot;).debugMode(true).build()</code></p>\n<h3 id=\"极简-API-设计\"><a href=\"#极简-API-设计\" class=\"headerlink\" title=\"极简 API 设计\"></a>极简 API 设计</h3><p>设计良好的 API 确保接入者能够轻松集成并使用你的 SDK 功能，避免不必要的复杂性。用 Kochava SDK 工程总监 <a href=\"https://appdevelopermagazine.com/building-better-sdks/\">Nathan Darst </a>的话说：</p>\n<blockquote>\n<p>The developer wants to solve a problem, and the API should facilitate solving this problem quickly and intuitively with as few lines of code as possible. A good API prioritizes and focuses on the most common use cases; it is not muddied up with unnecessary, ambiguous, redundant, or rarely used functionality likely to confuse the user.</p>\n<p>开发者的核心诉求是解决实际问题，而 API 的设计初衷，应是助力开发者<strong>用最少的代码、最直观的方式，快速解决问题</strong>。一个优质的 API，会优先聚焦并打磨<strong>最常用的核心使用场景</strong>；不会掺杂无关、模糊、冗余或极少用到的功能 —— 这类功能只会让使用者产生困惑。</p>\n</blockquote>\n<p>更多的代码准则应参考谷歌官方：<a href=\"https://source.android.com/docs/setup/contribute/api-guidelines?hl=zh-cn#basics-documented\">Android API 准则</a></p>\n<h3 id=\"轻量级-SDK\"><a href=\"#轻量级-SDK\" class=\"headerlink\" title=\"轻量级 SDK\"></a>轻量级 SDK</h3><p>尽量减少外部依赖，尤其是核心功能方面。如果非得用第三方库（Gson、okhttp等），就把它们隔离出来，或者更好的是，让接入者选择排除或替换这些工具，或者参考<a href=\"https://insert-koin.io/docs/setup/koin/\">koin</a>，采用模块化架构允许仅集成所需的组件。</p>\n<h3 id=\"错误处理、调试、测试\"><a href=\"#错误处理、调试、测试\" class=\"headerlink\" title=\"错误处理、调试、测试\"></a>错误处理、调试、测试</h3><p>当出现错误时，清晰且可作的响应帮助接入者快速识别并修复问题，减少挫败感，节省集成和故障排除的时间。尽可能将详细的错误返回或者在日志里面输出出来，不要只展示“未知错误”、”-1”、“errros”这些表达不明确的错误。</p>\n<p>除了明确的错误信息提示外，还需要提供一些详细详细日志，且可配置。以视频渲染SDK为例，由于有多个线程参与，还有 GPU 参与，断点调试几乎不太可能，如果在每一帧都打印日志的话，又会得到大量冗余的信息，所以这里就需要日志输出可配置化。</p>\n<p>为了更好地测试你的库，建议使用 <a href=\"https://en.wikipedia.org/wiki/Dependency_injection\">依赖注入</a>，这里以一份网络请求做对比-&gt;<a href=\"https://gist.github.com/VomPom/0571f87993c4512cb774257c234eccde\">使用依赖注入和不使用依赖注入的两种实现对比</a></p>\n<p>依赖注入通过解耦被测试类与具体依赖，实现依赖的灵活替换与精准模拟，让单元测试更可控、快速且用例间相互独立。</p>\n<h3 id=\"前后的兼容性\"><a href=\"#前后的兼容性\" class=\"headerlink\" title=\"前后的兼容性\"></a>前后的兼容性</h3><p>当 SDK 更新破坏现有 API 实现时，接入者会面临不必要的返工，通过保持向后兼容性，使接入者能够无缝采用新的 SDK 版本，同时不影响他们的工作流程。实现这一目标的一种广泛采用的策略是<a href=\"https://semver.org/\">语义版本控制（SemVer），</a> 它采用三部分版本控制方案，清晰传达变更的范围和影响：</p>\n<p>以 4.3.2 为例，<strong>4 是主版本号</strong>，其变更代表 SDK 出现了向后不兼容的破坏性修改，需适配调整才能使用；<strong>3 是次版本号</strong>，其变更为新增兼容式功能 / 特性，无需改动原有代码即可升级；<strong>2 是补丁版本号</strong>，其变更仅为兼容式 bug 修复，是最无风险的小版本升级。</p>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><p>这里主要是一些琐碎点，或者能提供一些在SDK 开发过程中的帮助</p>\n<h3 id=\"多利用语言特性\"><a href=\"#多利用语言特性\" class=\"headerlink\" title=\"多利用语言特性\"></a>多利用语言特性</h3><p>目前我遇到的利用 kotlin 特性最好的开源库是 <a href=\"https://github.com/InsertKoinIO/koin\">koin</a>，使用了大量的高阶函数 &amp; Lambda 表达式，比如：高阶函数 / Lambda实现简洁的 DSL 模块定义（module { … }），委托属性实现<code>by inject()</code> 延迟获取依赖，协程支持协程作用域、挂起函数创建依赖等</p>\n<p>演示代码片段：<a href=\"https://gist.github.com/VomPom/d1bfa7bb01baf0be148f970cb60dbd72\">koin使用到 kotlin 的一些特性</a></p>\n<h3 id=\"善于使用脚本\"><a href=\"#善于使用脚本\" class=\"headerlink\" title=\"善于使用脚本\"></a>善于使用脚本</h3><p>脚本可以帮助开发者实现很多重复工作，包括不限于：Android SDK 一键编译打包（AAR/JAR）、多版本编译（测试不同 Kotlin/AGP 版本）、自动更新 SDK 版本号、生成版本日志（结合 Git 提交记录）、测试自动化等，这里面有很多可以使用 Gradle脚本，有的也可使用 Shell 脚本。</p>\n<p>其他持续补充……</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>本人结合个人Android SDK开发经验，好用的SDK需围绕接入方体验、稳定性设计：接入前有清晰文档，接入中极简便捷，接入后无缝升级。开发者需遵循接入方体验为中心、最小化暴露、稳定性兜底三大原则，开发中做好文档、安装初始化、API设计等核心工作，善用Kotlin特性与自动化脚本。本文为个人经验总结，因SDK开发场景多样，不适用于所有情况，仅供学习参考。</p>\n<h3 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h3><p><a href=\"https://newsletter.pragmaticengineer.com/p/building-great-sdks\">Building great SDKs</a></p>\n<p><a href=\"https://proandroiddev.com/sdk-development-the-good-the-bad-the-ugly-9e9ab2a81697?gi=80902e83600f\">SDK Development; The Good, The Bad, The Ugly</a></p>\n<p><a href=\"https://www.shakebugs.com/blog/sdk-design-best-practices/\">SDK design best practices</a></p>\n<p><a href=\"https://anil-gudigar.medium.com/mobile-sdk-development-guidelines-eccb276d4df4\">Mobile SDK Development Guidelines</a></p>\n<p><a href=\"https://juejin.cn/post/6864723217831952392\">Android SDK开发艺术探索（一）开篇与设计</a> </p>\n<p><a href=\"https://appdevelopermagazine.com/building-better-sdks/\">Building Better SDKs</a></p>\n","cover":null,"images":[],"content":"<p>如何去设计一个好用的SDK，自己做了很久的SDK，实际上并没有过多去思考过这个问题。最近对起总结一下，在回答这个问题之前，我们可以自己思考一下：对于接入者，怎样才算是一个好的SDK？对我自己而言，如果我要去接入一个SDK的话，可能会去考虑分别针对几个阶段：</p>\n<p><strong>接入前：</strong> 有清晰的文档能告诉我这个SDK 的环境要求，比如 minSdkVersion compileSdkVersion 这些硬性配置，明确列出<strong>所有直接 / 间接依赖的第三方库及版本</strong>，以及包大小、申请权限等。</p>\n<p><strong>接入中：</strong>接入需要足够简单，在 dependencies 中一行搞定；如果有初始化操作也尽量简洁，一行搞定；对应 SDK 调用 ，提供一个单例类或者某个接口，在这个类/接口里面能够看到最核心的 Api；使用的接口对各种异常处理有足够多的错误提示信息；针对输出日志能够有配置开关等。</p>\n<p><strong>接入后：</strong> SDK 由于功能需要更新，需提供详尽的 CHANGELOG，接入者只用更新版本号；</p>\n<p>上面是站在接入者的角度去考虑的，作为SDK的开发者则应该遵循以下的规则。</p>\n<h2 id=\"先前原则\"><a href=\"#先前原则\" class=\"headerlink\" title=\"先前原则\"></a>先前原则</h2><p><strong>核心原则：以接入方体验为中心</strong></p>\n<p>在开发一个SDK的时候，把接入者当作“小白”，不寄希望于他能点进SDK内部，去了解内部的实现；把接入者视作“懒人”，他不想做太多事，他赖得看你代码里面的各种注释，只想看一份接入文档就搞定所有事情。</p>\n<p><strong>最小化原则：只暴露必要的内容</strong></p>\n<p>对外仅暴露<strong>核心入口类 + 必要数据类 + 统一结果类</strong>，内部工具类、中间逻辑、私有方法全部标记为<code>private</code>（Java）/<code>internal</code>（Kotlin），杜绝接入方依赖内部逻辑。</p>\n<p><strong>稳定性原则：避免崩溃，容错兜底</strong></p>\n<p>不要将你的SDK视为一个可以随时更新的应用程序，而应将其看作一旦上线就无法实时更新的后端服务。避免崩溃是第一前提，但不可能万无一失，会由于设备兼容性问题，没法在上线将所有情况全考虑到，那么需要SDK能够有兜底操作，比如某个开关能够关闭掉该功能，或者针对特定机型Android系统等进行屏蔽（需服务端配合）。</p>\n<h2 id=\"开发阶段\"><a href=\"#开发阶段\" class=\"headerlink\" title=\"开发阶段\"></a>开发阶段</h2><h3 id=\"详细的文档\"><a href=\"#详细的文档\" class=\"headerlink\" title=\"详细的文档\"></a>详细的文档</h3><p>接入需要清晰、详细的文档，了解如何充分发挥 SDK 的能力。一份全面的文档需要包含：</p>\n<ul>\n<li><p>SDK开发环境要求</p>\n</li>\n<li><p>SDK安装和配置的详细流程</p>\n</li>\n<li><p>核心 Api 使用的代码示例</p>\n</li>\n<li><p>有一个可进行索引的目录</p>\n</li>\n</ul>\n<h3 id=\"安装和初始化\"><a href=\"#安装和初始化\" class=\"headerlink\" title=\"安装和初始化\"></a>安装和初始化</h3><p>使用<strong>Maven Publish Plugin</strong>将 SDK 发布到 Maven 仓库，配置<code>groupId</code>/<code>artifactId</code>/<code>version</code>，确保接入方仅需一行<code>implementation</code>即可引入；</p>\n<p>避免在 AndroidManifest.xml 中配置冗余内容，如需一些动态配置，提供<strong>Gradle 插件自动注入</strong>这些能力，无需接入方手动修改。</p>\n<p>初始化的时候一行搞定，比如：<code>XxxSdk.Builder().appKey(&quot;your_app_key&quot;).debugMode(true).build()</code></p>\n<h3 id=\"极简-API-设计\"><a href=\"#极简-API-设计\" class=\"headerlink\" title=\"极简 API 设计\"></a>极简 API 设计</h3><p>设计良好的 API 确保接入者能够轻松集成并使用你的 SDK 功能，避免不必要的复杂性。用 Kochava SDK 工程总监 <a href=\"https://appdevelopermagazine.com/building-better-sdks/\">Nathan Darst </a>的话说：</p>\n<blockquote>\n<p>The developer wants to solve a problem, and the API should facilitate solving this problem quickly and intuitively with as few lines of code as possible. A good API prioritizes and focuses on the most common use cases; it is not muddied up with unnecessary, ambiguous, redundant, or rarely used functionality likely to confuse the user.</p>\n<p>开发者的核心诉求是解决实际问题，而 API 的设计初衷，应是助力开发者<strong>用最少的代码、最直观的方式，快速解决问题</strong>。一个优质的 API，会优先聚焦并打磨<strong>最常用的核心使用场景</strong>；不会掺杂无关、模糊、冗余或极少用到的功能 —— 这类功能只会让使用者产生困惑。</p>\n</blockquote>\n<p>更多的代码准则应参考谷歌官方：<a href=\"https://source.android.com/docs/setup/contribute/api-guidelines?hl=zh-cn#basics-documented\">Android API 准则</a></p>\n<h3 id=\"轻量级-SDK\"><a href=\"#轻量级-SDK\" class=\"headerlink\" title=\"轻量级 SDK\"></a>轻量级 SDK</h3><p>尽量减少外部依赖，尤其是核心功能方面。如果非得用第三方库（Gson、okhttp等），就把它们隔离出来，或者更好的是，让接入者选择排除或替换这些工具，或者参考<a href=\"https://insert-koin.io/docs/setup/koin/\">koin</a>，采用模块化架构允许仅集成所需的组件。</p>\n<h3 id=\"错误处理、调试、测试\"><a href=\"#错误处理、调试、测试\" class=\"headerlink\" title=\"错误处理、调试、测试\"></a>错误处理、调试、测试</h3><p>当出现错误时，清晰且可作的响应帮助接入者快速识别并修复问题，减少挫败感，节省集成和故障排除的时间。尽可能将详细的错误返回或者在日志里面输出出来，不要只展示“未知错误”、”-1”、“errros”这些表达不明确的错误。</p>\n<p>除了明确的错误信息提示外，还需要提供一些详细详细日志，且可配置。以视频渲染SDK为例，由于有多个线程参与，还有 GPU 参与，断点调试几乎不太可能，如果在每一帧都打印日志的话，又会得到大量冗余的信息，所以这里就需要日志输出可配置化。</p>\n<p>为了更好地测试你的库，建议使用 <a href=\"https://en.wikipedia.org/wiki/Dependency_injection\">依赖注入</a>，这里以一份网络请求做对比-&gt;<a href=\"https://gist.github.com/VomPom/0571f87993c4512cb774257c234eccde\">使用依赖注入和不使用依赖注入的两种实现对比</a></p>\n<p>依赖注入通过解耦被测试类与具体依赖，实现依赖的灵活替换与精准模拟，让单元测试更可控、快速且用例间相互独立。</p>\n<h3 id=\"前后的兼容性\"><a href=\"#前后的兼容性\" class=\"headerlink\" title=\"前后的兼容性\"></a>前后的兼容性</h3><p>当 SDK 更新破坏现有 API 实现时，接入者会面临不必要的返工，通过保持向后兼容性，使接入者能够无缝采用新的 SDK 版本，同时不影响他们的工作流程。实现这一目标的一种广泛采用的策略是<a href=\"https://semver.org/\">语义版本控制（SemVer），</a> 它采用三部分版本控制方案，清晰传达变更的范围和影响：</p>\n<p>以 4.3.2 为例，<strong>4 是主版本号</strong>，其变更代表 SDK 出现了向后不兼容的破坏性修改，需适配调整才能使用；<strong>3 是次版本号</strong>，其变更为新增兼容式功能 / 特性，无需改动原有代码即可升级；<strong>2 是补丁版本号</strong>，其变更仅为兼容式 bug 修复，是最无风险的小版本升级。</p>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><p>这里主要是一些琐碎点，或者能提供一些在SDK 开发过程中的帮助</p>\n<h3 id=\"多利用语言特性\"><a href=\"#多利用语言特性\" class=\"headerlink\" title=\"多利用语言特性\"></a>多利用语言特性</h3><p>目前我遇到的利用 kotlin 特性最好的开源库是 <a href=\"https://github.com/InsertKoinIO/koin\">koin</a>，使用了大量的高阶函数 &amp; Lambda 表达式，比如：高阶函数 / Lambda实现简洁的 DSL 模块定义（module { … }），委托属性实现<code>by inject()</code> 延迟获取依赖，协程支持协程作用域、挂起函数创建依赖等</p>\n<p>演示代码片段：<a href=\"https://gist.github.com/VomPom/d1bfa7bb01baf0be148f970cb60dbd72\">koin使用到 kotlin 的一些特性</a></p>\n<h3 id=\"善于使用脚本\"><a href=\"#善于使用脚本\" class=\"headerlink\" title=\"善于使用脚本\"></a>善于使用脚本</h3><p>脚本可以帮助开发者实现很多重复工作，包括不限于：Android SDK 一键编译打包（AAR/JAR）、多版本编译（测试不同 Kotlin/AGP 版本）、自动更新 SDK 版本号、生成版本日志（结合 Git 提交记录）、测试自动化等，这里面有很多可以使用 Gradle脚本，有的也可使用 Shell 脚本。</p>\n<p>其他持续补充……</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>本人结合个人Android SDK开发经验，好用的SDK需围绕接入方体验、稳定性设计：接入前有清晰文档，接入中极简便捷，接入后无缝升级。开发者需遵循接入方体验为中心、最小化暴露、稳定性兜底三大原则，开发中做好文档、安装初始化、API设计等核心工作，善用Kotlin特性与自动化脚本。本文为个人经验总结，因SDK开发场景多样，不适用于所有情况，仅供学习参考。</p>\n<h3 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h3><p><a href=\"https://newsletter.pragmaticengineer.com/p/building-great-sdks\">Building great SDKs</a></p>\n<p><a href=\"https://proandroiddev.com/sdk-development-the-good-the-bad-the-ugly-9e9ab2a81697?gi=80902e83600f\">SDK Development; The Good, The Bad, The Ugly</a></p>\n<p><a href=\"https://www.shakebugs.com/blog/sdk-design-best-practices/\">SDK design best practices</a></p>\n<p><a href=\"https://anil-gudigar.medium.com/mobile-sdk-development-guidelines-eccb276d4df4\">Mobile SDK Development Guidelines</a></p>\n<p><a href=\"https://juejin.cn/post/6864723217831952392\">Android SDK开发艺术探索（一）开篇与设计</a> </p>\n<p><a href=\"https://appdevelopermagazine.com/building-better-sdks/\">Building Better SDKs</a></p>\n","categories":[{"name":"思考总结","slug":"thinking","api":"api/categories/thinking.json"}],"tags":[{"name":"SDK","slug":"SDK","api":"api/tags/SDK.json"}],"api":"api/posts/2026/02/04/如何构建一个好用的SDK.json"}],"info":{"type":"archive","year":2026,"month":2}},"api":"api/archives/2026/02/page.1.json"}