<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="è½å¶æŒ½æ­Œ"><title>RecyclerViewè‡ªå®šä¹‰LayoutManagerä»0åˆ°1å®è·µ | è½å¶æŒ½æ­Œ</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/pure-min.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="https://unpkg.com/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + 'a642bfb7c75afbc4fe68fd942180298b';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="https://unpkg.com/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="https://unpkg.com/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="https://unpkg.com/toastr/build/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"><script src="/js/prism.js"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">RecyclerViewè‡ªå®šä¹‰LayoutManagerä»0åˆ°1å®è·µ</h1><a id="logo" href="/.">è½å¶æŒ½æ­Œ</a><p class="description">juliswang's åšå®¢</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="https://k.julis.wang"><i class="fa fa-wikipedia-w"> çŸ¥è¯†</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">RecyclerViewè‡ªå®šä¹‰LayoutManagerä»0åˆ°1å®è·µ</h1><div class="post-meta">2023å¹´10æœˆ31æ—¥<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4k</span><span class="post-meta-item-text"> å­—</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 16</span><span class="post-meta-item-text"> åˆ†é’Ÿ</span></span></span></div><div class="post-content"><p>æ­¤å‰å¤§éƒ¨åˆ†æ¶‰åŠåˆ° RecyclerView é¡µé¢çš„ LayoutManageråŸºæœ¬ä¸Šç”¨ç³»ç»Ÿæä¾›çš„ LinearLayoutManager ã€GridLayoutManager å°±èƒ½è§£å†³ï¼Œä½†åœ¨ä¸€äº›ç‰¹æ®Šåœºæ™¯ä¸Šè¿˜æ˜¯éœ€è¦æˆ‘ä»¬è‡ªå®šä¹‰  LayoutManagerã€‚ä¹‹å‰åŸºæœ¬ä¸Šæ²¡æœ‰è‡ªå·±å†™è¿‡ï¼Œåœ¨ç½‘ä¸Šçœ‹å„ç§æºç å„ç§æ–‡ç« ï¼Œåˆšå¼€å§‹èŠ±äº†å¥½å¤šæ—¶é—´å»ç†è§£æ•´ä½“æµç¨‹ï¼Œå› ä¸ºå®ƒä»¬éƒ½ç»™æˆ‘ä¸€ç§éå¸¸éå¸¸å¤æ‚çš„æ„Ÿè§‰ï¼ŒåŒ…æ‹¬ç›¸å…³çš„åšå®¢æ–‡ç« ä¹Ÿæ˜¯ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´æ‘¸ç´¢ï¼Œä¹Ÿæ…¢æ…¢èƒ½ç†è§£ä¸ºä»€ä¹ˆè¦é‚£ä¹ˆå¤æ‚äº†ï¼Œè¿™çš„ç¡®ä¸æ˜¯ç‰¹åˆ«å®¹æ˜“å…¥é—¨ã€‚æ‰€ä»¥å¯¹æ•´ä½“çš„æµç¨‹è¿›è¡Œäº†ä¸€ä¸ªæ‹†è§£ï¼Œå°½é‡åŸå­åŒ–ä¸€ç‚¹ï¼Œå¯¹è‡ªå·±å­¦ä¹ çš„ä¸€ä¸ªæ€»ç»“ï¼Œä¹Ÿå¸Œæœ›èƒ½å¸®åŠ©åˆ°ä¸€éƒ¨åˆ†äººèƒ½å¯¹  LayoutManager å…¥é—¨ã€‚</p>
<p>æœ¬æ–‡æœ€ç»ˆå®ç°ä¸€ä¸ªç®€å•çš„ LinearLayoutManagerï¼ˆåªæ”¯æŒ VERTICALï¼‰æ–¹å‘ï¼Œé€‚åˆå¯¹ LayoutManager æ•´ä½“æµç¨‹çš„å­¦ä¹ ä¸ç†è§£ï¼Œæ•´ä½“ä»£ç åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯å¯¹å‰ä¸€æ®µä»£ç çš„è¡¥å……ï¼Œæ–¹ä¾¿ç†è§£ï¼Œæ•´ä½“é¡¹ç›®æºç å·²æäº¤ Github: <a href="https://github.com/VomPom/LayoutManagerGradually">LayoutManagerGradually</a>ï¼Œä»£ç é‡Œé¢å†™äº†å¾ˆå¤šå¾ˆå¤šæ³¨é‡Šï¼Œå¦‚æœä¸æƒ³æµªè´¹æ—¶é—´ï¼Œå¯ä»¥ç›´æ¥çœ‹ä»£ç è¿è¡Œï¼Œè·³è¿‡è¿™ç¯‡æ–‡ç« ï¼ŒæŠŠæ¯ä¸€ä¸ª LayoutManager éƒ½è·‘ä¸€ä¸‹ä½“éªŒç»“åˆä»£ç çœ‹çœ‹ã€‚</p>
<h2 id="è‡ªå®šä¹‰-LayoutManager-çš„å¿…è¦å…ƒç´ "><a href="#è‡ªå®šä¹‰-LayoutManager-çš„å¿…è¦å…ƒç´ " class="headerlink" title="è‡ªå®šä¹‰ LayoutManager çš„å¿…è¦å…ƒç´ "></a>è‡ªå®šä¹‰ LayoutManager çš„å¿…è¦å…ƒç´ </h2><ul>
<li><p>ç»§æ‰¿ <code>RecyclerView.LayoutManager</code> å¹¶å®ç° <code>generateDefaultLayoutParams()</code>æ–¹æ³•</p>
</li>
<li><p>é‡å†™<code>onLayoutChildren</code> ç¬¬ä¸€æ¬¡æ•°æ®å¡«å……çš„æ—¶å€™æ•°æ®æ·»åŠ </p>
</li>
<li><p>é‡å†™ <code>canScrollHorizontally()</code> å’Œ<code>canScrollVertically()</code>æ–¹æ³•è®¾å®šæ”¯æŒæ»‘åŠ¨çš„æ–¹å‘</p>
</li>
<li><p>é‡å†™ <code>scrollHorizontallyBy()</code>å’Œ<code>scrollVerticallyBy()</code>æ–¹æ³•ï¼Œåœ¨æ»‘åŠ¨çš„æ—¶å€™å¯¹å±å¹•ä»¥å¤–çš„ View è¿›è¡Œå›æ”¶ï¼Œä»¥åŠå¡«å……å³å°†æ»‘åŠ¨è¿›å…¥å±å¹•èŒƒå›´å†…çš„ View è¿›è¡Œå¡«å……</p>
</li>
<li><p>é‡å†™ <code>scrollToPosition()</code>å’Œ<code>smoothScrollToPosition()</code>æ–¹æ³•æ”¯æŒ</p>
</li>
</ul>
<p>å…¶ä¸­<code>onLayoutChildren</code> å’Œ <code>scrollHorizontallyBy/scrollVerticallyBy</code> æ˜¯æœ€æ ¸å¿ƒä¸”æœ€å¤æ‚çš„æ–¹æ³•ï¼Œè¿™é‡Œç¨å¾®æ‹å‡ºæ¥è®²ä¸€ä¸‹</p>
<h3 id="onLayoutChildren"><a href="#onLayoutChildren" class="headerlink" title="onLayoutChildren"></a>onLayoutChildren</h3><p>è¿™ä¸ªæ–¹æ³•ç±»ä¼¼äºè‡ªå®šä¹‰ ViewGroup çš„ onLayout() æ–¹æ³•ï¼ŒRecyclerView çš„ LayoutManager.onLayoutChildren åœ¨ä»¥ä¸‹å‡ ä¸ªæ—¶æœºä¼šè¢«è§¦å‘ï¼š</p>
<ul>
<li>å½“ <code>RecyclerView</code> é¦–æ¬¡é™„åŠ åˆ°çª—å£æ—¶</li>
<li>å½“<code>Adapter</code>  çš„æ•°æ®é›†å‘ç”Ÿå˜åŒ–</li>
<li>å½“ <code>RecyclerView</code> è¢« æ‰§è¡Œ <code>RequetLayout</code>çš„æ—¶å€™</li>
<li>å½“ <code>LayoutManager</code> å‘ç”Ÿå˜åŒ–æ—¶</li>
</ul>
<h3 id="scrollHorizontallyBy-scrollVerticallyBy"><a href="#scrollHorizontallyBy-scrollVerticallyBy" class="headerlink" title="scrollHorizontallyBy/scrollVerticallyBy"></a>scrollHorizontallyBy/scrollVerticallyBy</h3><p>æ–¹æ³•çš„ä¸»è¦ä½œç”¨åŒ…æ‹¬ï¼š</p>
<ol>
<li><p>æ›´æ–° ItemView çš„ä½ç½®ï¼šæ ¹æ®ä¼ å…¥çš„å‚ç›´æ»šåŠ¨è·ç¦»ï¼ˆdy å‚æ•°ï¼‰ï¼Œæ›´æ–°å­è§†å›¾åœ¨å±å¹•ä¸Šçš„ä½ç½®ã€‚é€šå¸¸è°ƒç”¨ <code>offsetChildrenVertical</code> æ–¹æ³•ã€‚</p>
</li>
<li><p>å›æ”¶ä¸å¯è§çš„ ItemViewï¼šåœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­ï¼Œä¸€äº› ItemView å¯èƒ½ä¼šç¦»å¼€å±å¹•ï¼Œå˜å¾—ä¸å¯è§ã€‚<code>scrollVerticallyBy</code> æ–¹æ³•éœ€è¦è´Ÿè´£å›æ”¶è¿™äº›å­è§†å›¾å¹¶å°†å®ƒä»¬æ”¾å…¥å›æ”¶æ± ï¼Œä»¥ä¾¿ç¨åå¤ç”¨ã€‚</p>
</li>
<li><p>æ·»åŠ æ–°çš„ ItemViewï¼šåœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­ï¼Œæ–°çš„ ItemView å¯èƒ½éœ€è¦æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚<code>scrollVerticallyBy</code> æ–¹æ³•éœ€è¦ä»å›æ”¶æ± ä¸­è·å–å¯å¤ç”¨çš„è§†å›¾å¹¶å°†å®ƒä»¬æ·»åŠ åˆ°å±å¹•ä¸Šã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°è°ƒç”¨ <code>RecyclerView.Recycler</code> çš„ <code>getViewForPosition</code> æ–¹æ³•ã€‚</p>
</li>
<li><p>è¿”å›å®é™…æ»šåŠ¨è·ç¦»ï¼šç”±äº ItemView çš„æ•°é‡æœ‰é™ï¼Œæ»šåŠ¨å¯èƒ½ä¼šå—åˆ°é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œå½“æ»šåŠ¨åˆ°åˆ—è¡¨é¡¶éƒ¨æˆ–åº•éƒ¨æ—¶ï¼Œæ»šåŠ¨å¯èƒ½ä¼šåœæ­¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®é™…æ»šåŠ¨çš„è·ç¦»å¯èƒ½ä¼šå°äºä¼ å…¥çš„ <code>dy</code> å‚æ•°ã€‚<code>scrollVerticallyBy</code> æ–¹æ³•éœ€è¦è¿”å›å®é™…æ»šåŠ¨çš„è·ç¦»ï¼Œä»¥ä¾¿ <code>RecyclerView</code> å¯ä»¥æ­£ç¡®åœ°æ›´æ–°æ»šåŠ¨æ¡å’Œè§¦å‘æ»šåŠ¨äº‹ä»¶ã€‚</p>
</li>
</ol>
<p>æ¦‚å¿µå°±ç®€å•è®²è¿™ä¹ˆå¤šï¼Œ talk is cheap show me the codeï¼Œç›´æ¥çœ‹ä»£ç ç†è§£ä¼šæ¯”è¾ƒæ·±åˆ»</p>
<h2 id="é€æ­¥å®ç°"><a href="#é€æ­¥å®ç°" class="headerlink" title="é€æ­¥å®ç°"></a>é€æ­¥å®ç°</h2><p>è¦å®ç°ä¸€ä¸ªå¯ç”¨çš„ LayoutManger é€šå¸¸æˆ‘ä»¬éœ€è¦å®ç°ä»¥ä¸‹æµç¨‹</p>
<ul>
<li>æ•°æ®å¡«å……å¹¶ä¸”åªéœ€è¦å¡«å……å±å¹•èŒƒå›´å†…çš„ ItemView</li>
<li>å›æ”¶æ‰å±å¹•ä»¥å¤–çš„ ItemView</li>
<li>å±å¹•å¤– ItemView å†å›åˆ°å±å¹•åï¼Œéœ€è¦é‡æ–°å¡«å……</li>
<li>å¯¹æ»‘åŠ¨è¾¹ç•Œè¾¹ç•Œè¿›è¡Œå¤„ç†</li>
<li>å¯¹ scrollToPosition å’Œ smoothScrollToPositionè¿›è¡Œæ”¯æŒ</li>
</ul>
<p>æˆ‘ä»¬ä¸ç”¨ä¸€ä¸Šæ¥å°±å®ç°æœ€ç»ˆçš„æ•ˆæœï¼Œè€Œæ˜¯ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œçœ‹çœ‹ LayoutManger æ˜¯æ€ä¹ˆæ¸æ¸åœ°å˜åŒ–ï¼Œæœ€ç»ˆèƒ½è·‘èµ·æ¥çš„ã€‚</p>
<h3 id="0-æœ€ç®€å•çš„-LayoutManager"><a href="#0-æœ€ç®€å•çš„-LayoutManager" class="headerlink" title="0 æœ€ç®€å•çš„ LayoutManager"></a>0 æœ€ç®€å•çš„ LayoutManager</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/MostSimpleLayoutManager.kt">MostSimpleLayoutManager</a>ï¼Œæˆ‘ä»¬å…³æ³¨ <code>onLayoutChildren</code> æ–¹æ³•:</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onLayoutChildren</span><span class="params">(recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>, state: <span class="type">RecyclerView</span>.<span class="type">State</span>?)</span></span> &#123;</span><br><span class="line">    <span class="comment">// å‚ç›´æ–¹å‘çš„åç§»é‡</span></span><br><span class="line">    <span class="keyword">var</span> offsetTop = <span class="number">0</span></span><br><span class="line">    <span class="comment">// å®é™…ä¸šåŠ¡ä¸­æœ€å¥½ä¸è¦è¿™æ ·ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„æ•°æ®ï¼Œè¿™é‡Œåªæ˜¯æœ€ç®€å•åœ°æ¼”ç¤ºä¸€ä¸‹æ•´ä½“æ˜¯å¦‚ä½•å·¥ä½œçš„</span></span><br><span class="line">    <span class="keyword">for</span> (itemIndex <span class="keyword">in</span> <span class="number">0</span> until itemCount) &#123;</span><br><span class="line">        <span class="comment">// ä»é€‚é…å™¨è·å–ä¸ç»™å®šä½ç½®å…³è”çš„è§†å›¾</span></span><br><span class="line">        <span class="keyword">val</span> itemView = recycler.getViewForPosition(itemIndex)</span><br><span class="line">        <span class="comment">// å°†è§†å›¾æ·»åŠ åˆ° RecyclerView ä¸­</span></span><br><span class="line">        addView(itemView)</span><br><span class="line">        <span class="comment">// æµ‹é‡å¹¶å¸ƒå±€è§†å›¾</span></span><br><span class="line">        measureChildWithMargins(itemView, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°å®½é«˜ï¼ˆåŒ…æ‹¬ItemDecorationï¼‰</span></span><br><span class="line">        <span class="keyword">val</span> width = getDecoratedMeasuredWidth(itemView)</span><br><span class="line">        <span class="keyword">val</span> height = getDecoratedMeasuredHeight(itemView)</span><br><span class="line">        <span class="comment">// å¯¹è¦æ·»åŠ çš„å­ View è¿›è¡Œå¸ƒå±€</span></span><br><span class="line">        layoutDecorated(itemView, <span class="number">0</span>, offsetTop, width, offsetTop + height)</span><br><span class="line">        offsetTop += height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¸»è¦æ¼”ç¤ºäº†ï¼Œå¦‚ä½•åˆ©ç”¨<code>addView</code> <code>layoutDecorated</code>ç­‰æ–¹æ³•ï¼Œå°† ItemView æ·»åŠ åˆ° RecyclerView ä¸Šã€‚ä»£ç å¯è§æ˜¯ å°†æ‰€æœ‰çš„ ItemViewï¼ˆå³ä½¿å®ƒåœ¨å±å¹•ä¸Šä¸å¯è§ï¼‰ä¸€æ¬¡æ€§å…¨éƒ¨åŠ è½½åˆ°äº† RecyclerViewä¸Šï¼Œ è¿™é‡Œä¸€èˆ¬ä¸è¿™ä¹ˆåšï¼Œåªæ˜¯è¿™é‡Œè¿™é‡Œåªæ˜¯æœ€ç®€å•åœ°æ¼”ç¤ºä¸€ä¸‹æ•´ä½“æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šItemæ•°æ®å·²ç»è¢«å…¨éƒ¨æ·»åŠ åˆ°ç•Œé¢ä¸Šäº†ï¼Œå¹¶ä¸”å„ä¸ªæ–¹å‘çš„æ»‘åŠ¨éƒ½æ”¯æŒã€‚</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_0.gif?imageView2/2/w/300">
<h3 id="1-æ›´åˆç†çš„æ•°æ®æ·»åŠ æ–¹å¼"><a href="#1-æ›´åˆç†çš„æ•°æ®æ·»åŠ æ–¹å¼" class="headerlink" title="1 æ›´åˆç†çš„æ•°æ®æ·»åŠ æ–¹å¼"></a>1 æ›´åˆç†çš„æ•°æ®æ·»åŠ æ–¹å¼</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager1">LinearLayoutManager1.kt</a></p>
<p>å¯¹æœ€å¼€å§‹çš„ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œåªåœ¨å±å¹•èŒƒå›´å†…çš„åŒºåŸŸè¿›è¡Œæ•°æ®çš„æ·»åŠ ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¸€æ¬¡æ€§å°†æ‰€æœ‰æ•°æ®å°±æ·»åŠ ä¸Šå»ï¼Œå¦‚æœ Adapter çš„ ItemCount è¶³å¤Ÿå·¨å¤§ï¼Œfor all addView çš„è¯ï¼Œå¾ˆå®¹æ˜“å°± OOMã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onLayoutChildren</span><span class="params">(recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>, state: <span class="type">RecyclerView</span>.<span class="type">State</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// å‚ç›´æ–¹å‘ä¸Šçš„çš„ç©ºé—´å¤§å°</span></span><br><span class="line">    <span class="keyword">var</span> remainSpace = height - paddingTop</span><br><span class="line">    <span class="comment">//å‚ç›´æ–¹å‘çš„åç§»é‡</span></span><br><span class="line">    <span class="keyword">var</span> offsetTop = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> currentPosition = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (remainSpace &gt; <span class="number">0</span> &amp;&amp; currentPosition &lt; state.itemCount) &#123;</span><br><span class="line">        <span class="comment">// ä»é€‚é…å™¨è·å–ä¸ç»™å®šä½ç½®å…³è”çš„è§†å›¾</span></span><br><span class="line">        <span class="keyword">val</span> itemView = recycler.getViewForPosition(currentPosition)</span><br><span class="line">        <span class="comment">// å°†è§†å›¾æ·»åŠ åˆ° RecyclerView ä¸­</span></span><br><span class="line">        addView(itemView)</span><br><span class="line">        <span class="comment">// æµ‹é‡å¹¶å¸ƒå±€è§†å›¾</span></span><br><span class="line">        measureChildWithMargins(itemView, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°å®½é«˜ï¼ˆåŒ…æ‹¬ItemDecorationï¼‰</span></span><br><span class="line">        <span class="keyword">val</span> itemWidth = getDecoratedMeasuredWidth(itemView)</span><br><span class="line">        <span class="keyword">val</span> itemHeight = getDecoratedMeasuredHeight(itemView)</span><br><span class="line">        <span class="comment">// å¯¹è¦æ·»åŠ çš„å­ View è¿›è¡Œå¸ƒå±€</span></span><br><span class="line">        layoutDecorated(itemView, <span class="number">0</span>, offsetTop, itemWidth, offsetTop + itemHeight)</span><br><span class="line">        offsetTop += itemHeight</span><br><span class="line">        currentPosition++</span><br><span class="line">        <span class="comment">// å¯ç”¨ç©ºé—´å‡å°‘</span></span><br><span class="line">        remainSpace -= itemHeight</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-å¯¹å±å¹•å¤–çš„Viewå›æ”¶"><a href="#2-å¯¹å±å¹•å¤–çš„Viewå›æ”¶" class="headerlink" title="2 å¯¹å±å¹•å¤–çš„Viewå›æ”¶"></a>2 å¯¹å±å¹•å¤–çš„Viewå›æ”¶</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager2.kt">LinearLayoutManager2</a></p>
<p>RecylerView æ²¡æœ‰ recycler æ€ä¹ˆè¡Œå‘¢ï¼Ÿå½“ RecylerView çš„ ItemView æ»‘å‡ºå±å¹•åæˆ‘ä»¬éœ€è¦å¯¹é½è¿›è¡Œå›æ”¶ï¼Œå®ç°çš„è¯éœ€è¦åœ¨ <code>scrollVerticallyBy</code>ä¸­ï¼Œæ¯”è¾ƒå¤æ‚çš„é€»è¾‘å°±æ˜¯æ€ä¹ˆå»åˆ¤æ–­ï¼šItemView åœ¨å±å¹•ä»¥å¤–ï¼Œæœ€ååˆ©ç”¨ï¼š<code>removeAndRecycleView</code>æ–¹æ³•è¿›è¡Œå›æ”¶</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">scrollVerticallyBy</span><span class="params">(dy: <span class="type">Int</span>, recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>, state: <span class="type">RecyclerView</span>.<span class="type">State</span>?)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">      <span class="comment">// åœ¨è¿™é‡Œå¤„ç†ä¸Šä¸‹çš„æ»šåŠ¨é€»è¾‘ï¼Œdy è¡¨ç¤ºæ»šåŠ¨çš„è·ç¦»</span></span><br><span class="line">      <span class="comment">// å¹³ç§»æ‰€æœ‰å­è§†å›¾</span></span><br><span class="line">      offsetChildrenVertical(-dy)</span><br><span class="line">      <span class="comment">// å¦‚æœå®é™…æ»šåŠ¨è·ç¦»ä¸ dy ç›¸åŒï¼Œè¿”å› dyï¼›å¦‚æœæœªæ»šåŠ¨ï¼Œè¿”å› 0</span></span><br><span class="line">      recycleInvisibleView(dy, recycler)</span><br><span class="line">      <span class="keyword">return</span> dy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å›æ”¶æ‰åœ¨ç•Œé¢ä¸Šçœ‹ä¸åˆ°çš„ ItemView</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dy</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> recycler</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">recycleInvisibleView</span><span class="params">(dy: <span class="type">Int</span>, recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> totalSpace = orientationHelper.totalSpace</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è¦å›æ”¶Viewçš„é›†åˆ</span></span><br><span class="line">    <span class="keyword">val</span> recycleViews = hashSetOf&lt;View&gt;()</span><br><span class="line">    <span class="comment">// ä»ä¸‹å¾€ä¸Šæ»‘</span></span><br><span class="line">    <span class="keyword">if</span> (dy &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0</span> until childCount) &#123;</span><br><span class="line">            <span class="keyword">val</span> child = getChildAt(i)!!</span><br><span class="line">            <span class="comment">// ä»ä¸‹å¾€ä¸Šæ»‘ä»æœ€ä¸Šé¢çš„ item å¼€å§‹è®¡ç®—</span></span><br><span class="line">            <span class="keyword">val</span> top = getDecoratedTop(child)</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æœ€é¡¶éƒ¨çš„ item æ˜¯å¦å·²ç»å®Œå…¨ä¸å¯è§ï¼Œå¦‚ä½•å¯è§ï¼Œé‚£è¯´æ˜åº•ä¸‹çš„ item ä¹Ÿæ˜¯å¯è§</span></span><br><span class="line">            <span class="keyword">val</span> height = top - getDecoratedBottom(child)</span><br><span class="line">            <span class="keyword">if</span> (height - top &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">            recycleViews.add(child)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dy &lt; <span class="number">0</span>) &#123;   <span class="comment">// ä»ä¸Šå¾€ä¸‹æ»‘</span></span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> childCount - <span class="number">1</span> downTo <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">val</span> child = getChildAt(i)!!</span><br><span class="line">            <span class="comment">// ä»ä¸Šå¾€ä¸‹æ»‘ä»æœ€åº•éƒ¨çš„ item å¼€å§‹è®¡ç®—</span></span><br><span class="line">            <span class="keyword">val</span> bottom = getDecoratedBottom(child)</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æœ€åº•éƒ¨çš„ item æ˜¯å¦å·²ç»å®Œå…¨ä¸å¯è§ï¼Œå¦‚ä½•å¯è§ï¼Œé‚£è¯´æ˜ä¸Šé¢çš„ item ä¹Ÿæ˜¯å¯è§</span></span><br><span class="line">            <span class="keyword">val</span> height = bottom - getDecoratedTop(child)</span><br><span class="line">            <span class="keyword">if</span> (bottom - totalSpace &lt; height) &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">            recycleViews.add(child)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœŸæ­£æŠŠ View ç§»é™¤æ‰çš„é€»è¾‘</span></span><br><span class="line">    <span class="keyword">for</span> (view <span class="keyword">in</span> recycleViews) &#123;</span><br><span class="line">        <span class="comment">// [removeAndRecycleView]</span></span><br><span class="line">        <span class="comment">// ç”¨äºä»è§†å›¾å±‚æ¬¡ç»“æ„ä¸­åˆ é™¤æŸä¸ªè§†å›¾ï¼Œå¹¶å°†å…¶èµ„æºå›æ”¶ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶é‡æ–°åˆ©ç”¨</span></span><br><span class="line">        removeAndRecycleView(view, recycler)</span><br><span class="line">    &#125;</span><br><span class="line">    recycleViews.clear()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šæ»‘å‡ºå±å¹•å¤–çš„ItemView è¢«å›æ”¶æ‰äº†</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_2.gif?imageView2/2/w/300">
<h3 id="3-å‘ä¸Šæ»‘åŠ¨çš„æ—¶Viewçš„å¡«å……"><a href="#3-å‘ä¸Šæ»‘åŠ¨çš„æ—¶Viewçš„å¡«å……" class="headerlink" title="3 å‘ä¸Šæ»‘åŠ¨çš„æ—¶Viewçš„å¡«å……"></a>3 å‘ä¸Šæ»‘åŠ¨çš„æ—¶Viewçš„å¡«å……</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager3.kt">LinearLayoutManager3</a></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">scrollVerticallyBy</span><span class="params">(dy: <span class="type">Int</span>, recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>, state: <span class="type">RecyclerView</span>.<span class="type">State</span>?)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="comment">// å¡«å…… view</span></span><br><span class="line">    fillView(dy, recycler)</span><br><span class="line">    <span class="comment">// ç§»åŠ¨ view</span></span><br><span class="line">    offsetChildrenVertical(-dy)</span><br><span class="line">    <span class="comment">// å›æ”¶ View</span></span><br><span class="line">    recycleInvisibleView(dy, recycler)</span><br><span class="line">    <span class="keyword">return</span> dy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¡«å……é‡æ–°è¿›å…¥å±å¹•å†…çš„ ItemView</span></span><br><span class="line"><span class="comment"> *     getChildCount():childCount-&gt; å½“å‰å±å¹•å†…RecyclerViewå±•ç¤ºçš„ ItemView æ•°é‡</span></span><br><span class="line"><span class="comment"> *     getItemCount():itemCount-&gt; æœ€å¤§çš„ ItemView æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ Adapter ä¼ é€’çš„æ•°æ®çš„æ•°é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">fillView</span><span class="params">(dy: <span class="type">Int</span>, recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> verticalSpace = orientationVerticalHelper.totalSpace</span><br><span class="line">    <span class="keyword">var</span> remainSpace = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> nextFillPosition = <span class="number">0</span></span><br><span class="line">    <span class="comment">//å‚ç›´æ–¹å‘çš„åç§»é‡</span></span><br><span class="line">    <span class="keyword">var</span> offsetTop = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> offsetLeft = <span class="number">0</span></span><br><span class="line">    <span class="comment">// ä»ä¸‹å¾€ä¸Šæ»‘ï¼Œé‚£ä¹ˆéœ€è¦å‘åº•éƒ¨æ·»åŠ æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span> (dy &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">val</span> anchorView = getChildAt(childCount - <span class="number">1</span>) ?: <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">val</span> anchorPosition = getPosition(anchorView)</span><br><span class="line">        <span class="keyword">val</span> anchorBottom = getDecoratedBottom(anchorView)</span><br><span class="line">        <span class="keyword">val</span> anchorLeft = getDecoratedLeft(anchorView)</span><br><span class="line">        remainSpace = verticalSpace - anchorBottom</span><br><span class="line">        <span class="comment">// å‚ç›´å¯ç”¨çš„æ•°æ®ä¸º&lt;0ï¼Œæ„å¤–ç€è¿™æ—¶å€™å±å¹•åº•éƒ¨çš„ä½ç½®åˆšå¥½åœ¨æœ€åº•éƒ¨çš„ ItemView ä¸Šï¼Œè¿˜éœ€è¦å‘ä¸Šæ»‘åŠ¨ä¸€ç‚¹ç‚¹...æˆ‘ä»¬æ‰èƒ½æ·»åŠ  View</span></span><br><span class="line">        <span class="keyword">if</span> (remainSpace &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        nextFillPosition = anchorPosition + <span class="number">1</span></span><br><span class="line">        offsetTop = anchorBottom</span><br><span class="line">        offsetLeft = anchorLeft</span><br><span class="line">        <span class="keyword">if</span> (nextFillPosition &gt;= itemCount) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dy &lt; <span class="number">0</span>) &#123;  <span class="comment">// ä»ä¸Šå¾€ä¸‹æ»‘ï¼Œé‚£ä¹ˆéœ€è¦å‘é¡¶éƒ¨æ·»åŠ æ•°æ®</span></span><br><span class="line">        <span class="comment">//no-op æš‚æ—¶ä¸å®ç°ä»ä¸Šå¾€ä¸‹æ»‘çš„åº•éƒ¨æ•°æ®å¡«å……</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (remainSpace &gt; <span class="number">0</span> &amp;&amp; nextFillPosition &lt; itemCount) &#123;</span><br><span class="line">        <span class="comment">// ä»é€‚é…å™¨è·å–ä¸ç»™å®šä½ç½®å…³è”çš„è§†å›¾</span></span><br><span class="line">        <span class="keyword">val</span> itemView = recycler.getViewForPosition(nextFillPosition)</span><br><span class="line">        <span class="comment">// å°†è§†å›¾æ·»åŠ åˆ° RecyclerView ä¸­</span></span><br><span class="line">        addView(itemView)</span><br><span class="line">        <span class="comment">// æµ‹é‡å¹¶å¸ƒå±€è§†å›¾</span></span><br><span class="line">        measureChildWithMargins(itemView, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°å®½é«˜ï¼ˆåŒ…æ‹¬ItemDecorationï¼‰</span></span><br><span class="line">        <span class="keyword">val</span> itemWidth = getDecoratedMeasuredWidth(itemView)</span><br><span class="line">        <span class="keyword">val</span> itemHeight = getDecoratedMeasuredHeight(itemView)</span><br><span class="line">        <span class="comment">// å¯¹è¦æ·»åŠ çš„å­ View è¿›è¡Œå¸ƒå±€ï¼Œç›¸æ¯”onLayoutChildren é‡Œé¢çš„å®ç°æ·»åŠ äº†ï¼šoffsetLeftï¼ˆå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ç¦æ­¢æ‰ å·¦å³çš„æ»‘åŠ¨ï¼‰</span></span><br><span class="line">        <span class="comment">// è¯•ç€æŠŠ offsetLeft æ”¹æˆ0ï¼Œä¹Ÿå°±æ˜¯æœ€åŸå§‹çš„æ ·å­ï¼Œç„¶åå·¦å³ä¸Šä¸‹æ»‘æ»‘ï¼Œä½ ä¼šæœ‰æ„å¤–æ”¶è·</span></span><br><span class="line">        layoutDecorated(itemView, offsetLeft, offsetTop, itemWidth + offsetLeft, offsetTop + itemHeight)</span><br><span class="line">        offsetTop += itemHeight</span><br><span class="line">        nextFillPosition++</span><br><span class="line">        <span class="comment">// å¯ç”¨ç©ºé—´å‡å°‘</span></span><br><span class="line">        remainSpace -= itemHeight</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šå‘ä¸Šæ»‘åŠ¨çš„æ—¶å€™ï¼Œåº•éƒ¨é™†ç»­æœ‰å…ƒç´ å¡«å……ï¼Œä½†å‘ä¸‹æ»‘åŠ¨çš„æ—¶å€™æ²¡æœ‰å¡«å……æ•°æ®</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_3.gif?imageView2/2/w/300">
<h3 id="4-ä¸¤ä¸ªæ–¹å‘çš„Viewå¡«å……"><a href="#4-ä¸¤ä¸ªæ–¹å‘çš„Viewå¡«å……" class="headerlink" title="4 ä¸¤ä¸ªæ–¹å‘çš„Viewå¡«å……"></a>4 ä¸¤ä¸ªæ–¹å‘çš„Viewå¡«å……</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager4.kt">LinearLayoutManager4</a></p>
<p>è¡¥é½ä»ä¸Šå¾€ä¸‹æ»‘ä¹‹åæ·»åŠ çš„é€»è¾‘</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">fillView</span><span class="params">(dy: <span class="type">Int</span>, recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> verticalSpace = orientationVerticalHelper.totalSpace</span><br><span class="line">    <span class="keyword">var</span> remainSpace = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> nextFillPosition = <span class="number">0</span></span><br><span class="line">    <span class="comment">//å‚ç›´æ–¹å‘çš„åç§»é‡</span></span><br><span class="line">    <span class="keyword">var</span> offsetTop = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> offsetLeft = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»ä¸‹å¾€ä¸Šæ»‘ï¼Œé‚£ä¹ˆéœ€è¦å‘åº•éƒ¨æ·»åŠ æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span> (dy &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        â€¦â€¦</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dy &lt; <span class="number">0</span>) &#123;  <span class="comment">// ä»ä¸Šå¾€ä¸‹æ»‘ï¼Œé‚£ä¹ˆéœ€è¦å‘é¡¶éƒ¨æ·»åŠ æ•°æ®</span></span><br><span class="line">        <span class="keyword">val</span> anchorView = getChildAt(<span class="number">0</span>) ?: <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">val</span> anchorPosition = getPosition(anchorView)</span><br><span class="line">        <span class="keyword">val</span> anchorTop = getDecoratedTop(anchorView)</span><br><span class="line">        offsetLeft = getDecoratedLeft(anchorView)</span><br><span class="line">        remainSpace = anchorTop</span><br><span class="line">        <span class="comment">// å‚ç›´å¯ç”¨çš„æ•°æ®ä¸º&lt;0ï¼Œæ„å¤–ç€è¿™æ—¶å€™å±å¹•é¡¶éƒ¨çš„ä½ç½®åˆšå¥½åœ¨æœ€åº•éƒ¨çš„ ItemView ä¸Šï¼Œè¿˜éœ€è¦å‘ä¸‹æ»‘åŠ¨ä¸€ç‚¹ç‚¹...æˆ‘ä»¬æ‰èƒ½æ·»åŠ  View</span></span><br><span class="line">        <span class="keyword">if</span> (anchorTop &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        nextFillPosition = anchorPosition - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (nextFillPosition &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">val</span> itemHeight = getDecoratedMeasuredHeight(anchorView)</span><br><span class="line">        <span class="comment">// æ–°çš„å¸ƒå±€çš„itemView çš„é¡¶éƒ¨ä½ç½®åº”è¯¥ä»¥ anchorTop - itemHeight å¼€å§‹</span></span><br><span class="line">        offsetTop = anchorTop - itemHeight</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (remainSpace &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        ((nextFillPosition &lt; itemCount) &amp;&amp; (nextFillPosition &gt;= <span class="number">0</span>))</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="comment">// ä»é€‚é…å™¨è·å–ä¸ç»™å®šä½ç½®å…³è”çš„è§†å›¾</span></span><br><span class="line">        <span class="keyword">val</span> itemView = recycler.getViewForPosition(nextFillPosition)</span><br><span class="line">        <span class="comment">// å°†è§†å›¾æ·»åŠ åˆ° RecyclerView ä¸­kï¼Œä»é¡¶éƒ¨æ·»åŠ çš„è¯ï¼Œéœ€è¦åŠ åˆ°æœ€å‰çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">if</span> (dy &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            addView(itemView)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            addView(itemView, <span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        â€¦â€¦</span><br><span class="line">        <span class="keyword">if</span> (dy &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            offsetTop += itemHeight</span><br><span class="line">            nextFillPosition++</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            offsetTop -= itemHeight</span><br><span class="line">            nextFillPosition--</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯ç”¨ç©ºé—´å‡å°‘</span></span><br><span class="line">        remainSpace -= itemHeight</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šå‘ä¸Šæˆ–è€…æ»‘åŠ¨çš„æ—¶å€™ï¼Œåº•éƒ¨é™†ç»­éƒ½æœ‰å…ƒç´ å¡«å……</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_4.gif?imageView2/2/w/300">
<h3 id="5-å¯¹é¡¶éƒ¨å’Œåº•éƒ¨æ»‘åŠ¨è¾¹ç•Œå¤„ç†"><a href="#5-å¯¹é¡¶éƒ¨å’Œåº•éƒ¨æ»‘åŠ¨è¾¹ç•Œå¤„ç†" class="headerlink" title="5 å¯¹é¡¶éƒ¨å’Œåº•éƒ¨æ»‘åŠ¨è¾¹ç•Œå¤„ç†"></a>5 å¯¹é¡¶éƒ¨å’Œåº•éƒ¨æ»‘åŠ¨è¾¹ç•Œå¤„ç†</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager5.kt">LinearLayoutManager5</a></p>
<p>å¯¹äºå‰é¢çš„å®ç°ä¼šå‘ç°ä¼šï¼šä¸åœåœ°ä¸‹æ»‘æˆ–è€…ä¸Šæ»‘ä¼šç•™å‡ºæ¥å·¨å¤§çš„ç©ºç™½ã€‚è¿™é‡Œå¯¹å¡«å…… View çš„é€»è¾‘è¿›è¡Œæ”¹é€ ï¼Œéœ€è¦è¿›è¡Œè¾¹ç•Œæ£€æµ‹ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">scrollVerticallyBy</span><span class="params">(dy: <span class="type">Int</span>, recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>, state: <span class="type">RecyclerView</span>.<span class="type">State</span>?)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="comment">// å¡«å…… view</span></span><br><span class="line">    <span class="keyword">val</span> adjustedDy = fillView(dy, recycler)</span><br><span class="line">    <span class="comment">// ç§»åŠ¨ view</span></span><br><span class="line">    offsetChildrenVertical(-adjustedDy)</span><br><span class="line">    <span class="comment">// å›æ”¶ View</span></span><br><span class="line">    recycleInvisibleView(adjustedDy, recycler)</span><br><span class="line">    <span class="comment">// ç”±äºéœ€è¦å¯¹è¾¹ç•Œè¿›è¡Œé™åˆ¶ï¼Œæ‰€ä»¥éœ€è¦å¯¹åŸå§‹çš„ dy è¿›è¡Œä¿®æ­£ï¼Œè¿™é‡Œä¸å†ç›´æ¥è¿”å› dy</span></span><br><span class="line">    <span class="keyword">return</span> adjustedDy</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„æ•´ä½“æ³¨é‡Šæˆ‘å†™åœ¨äº†ä»£ç é‡Œé¢ï¼Œå¯ä»¥çœ‹å›¾ç¨å¾®ç†è§£ä¸€ä¸‹ï¼Œä»¥å‘ä¸Šæ»‘åŠ¨ä¸ºä¾‹ï¼šå‡è®¾è¿™ä¸€æ¬¡æ»‘åŠ¨çš„è·ç¦»éå¸¸éå¸¸å¤§(æƒ³è±¡æˆ10000åƒç´ )ï¼Œå¦‚æœç›´æ¥æ»‘åŠ¨çš„è¯ï¼Œæˆ‘ä»¬æœ‰50ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ é«˜åº¦100åƒç´ ï¼Œæœ€å¤§é«˜åº¦ä¹Ÿåªæœ‰50x100=5000ï¼Œé‚£ä¹ˆæ»‘åŠ¨åä¸€å®šä¼šç•™ä¸‹å¤§é‡ç©ºåŒºåŸŸã€‚éœ€è¦å¯¹å½“å‰ä¼ å…¥çš„è¿™ 10000 åƒç´ åšè°ƒæ•´ï¼šåªç»™åˆ°å¯æ»‘åŠ¨çš„æœ€å¤§è·ç¦»ï¼Œå¦‚æœä¸èƒ½æ»‘åŠ¨äº†å°±è¿”å›0ã€‚</p>
<img src="https://cdn.julis.wang/blog/img/5_scroll_limit.png">
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šå‘ä¸Šæˆ–è€…æ»‘åŠ¨çš„æ—¶å€™ï¼Œè¾¾åˆ°æœ€å¤§çš„ä½ç½®æ—¶å€™æ˜¯ä¸èƒ½å†æ»‘åŠ¨çš„ã€‚</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_5.gif?imageView2/2/w/300">
<h3 id="6-å®ç°-scrollToPosition"><a href="#6-å®ç°-scrollToPosition" class="headerlink" title="6 å®ç° scrollToPosition"></a>6 å®ç° scrollToPosition</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager6.kt">LinearLayoutManager6</a></p>
<p>åˆ°è¿™é‡Œè¿™ä¸ª LinearLayoutManager çœ‹ç€å·²ç»èƒ½æ­£å¸¸è¿è¡Œäº†ï¼Œä½†ä¸€èˆ¬è¿˜éœ€è¦æ”¯æŒ<code>scrollToPosition</code> å’Œ <code>smoothScrollToPositio</code></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> mPendingScrollPosition = RecyclerView.NO_POSITION</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">scrollToPosition</span><span class="params">(position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.scrollToPosition(position)</span><br><span class="line">    <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= itemCount) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    mPendingScrollPosition = position</span><br><span class="line">    requestLayout()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onLayoutChildren</span><span class="params">(recycler: <span class="type">RecyclerView</span>.<span class="type">Recycler</span>, state: <span class="type">RecyclerView</span>.<span class="type">State</span>)</span></span> &#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">    <span class="keyword">var</span> currentPosition = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> (mPendingScrollPosition != RecyclerView.NO_POSITION) &#123;</span><br><span class="line">        currentPosition = mPendingScrollPosition</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (remainSpace &gt; <span class="number">0</span> &amp;&amp; currentPosition &lt; state.itemCount) &#123;</span><br><span class="line">      â€¦â€¦ <span class="comment">// å¡«å……View çš„é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>scrollToPosition</code> çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå¦‚ä¸Šä»£ç æ‰€ç¤ºï¼šåœ¨ <code>scrollToPosition</code>  çš„æ—¶å€™è®°å½•ä¸€æ¬¡ç›®æ ‡positionï¼Œå† requestLayout ä¸€æ³¢ï¼Œè¿˜è®°å¾—ä¹‹å‰æœ‰æåˆ°è¿‡ï¼š<code>onLayoutChildren</code> ä¼šåœ¨ <code>requestLayout</code> çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œäºæ˜¯å†å°†<code>onLayoutChildren</code>é€»è¾‘æ”¹å†™ï¼Œä¸å†ä»ç¬¬0ä¸ªå…ƒç´ å¼€å§‹ï¼Œè€Œæ˜¯ä»ç›®æ ‡ä½ç½®è¿›è¡Œå¸ƒå±€ã€‚</p>
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šç‚¹å‡» scrollTo30 å°†ä¼šæ»‘åŠ¨åˆ° ç¬¬30ä¸ªä½ç½®ã€‚</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_6.gif?imageView2/2/w/300">
<h3 id="7-å®ç°-smoothScrollToPosition"><a href="#7-å®ç°-smoothScrollToPosition" class="headerlink" title="7 å®ç° smoothScrollToPosition"></a>7 å®ç° smoothScrollToPosition</h3><p>ä»£ç æŸ¥çœ‹ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually/tree/main/layoutmanager/src/main/java/com/julis/layoutmanager/series/LinearLayoutManager7.kt">LinearLayoutManager7</a>  </p>
<p>è¦å®ç°è‡ªå®šä¹‰çš„ smoothScrollToPosition åŠ¨ç”»æ•ˆæœï¼Œè¿™ä¸€å—å¦‚æœè¦å®Œå…¨è‡ªå·±å®ç°çš„è¯æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„ LinearSmoothScrolleræ”¹é€ ,ä¹Ÿå¯ä»¥ç»§æ‰¿ RecyclerView.SmoothScroller è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥å®Œå…¨ä¸ä½¿ç”¨ SmoothScrollerï¼Œ ç…§ç€ SmoothScroller çš„å®ç°ä½¿ç”¨ç±»ä¼¼ ValueAnimator è‡ªå®šä¹‰åŠ¨ç”»ï¼Œæ·»åŠ åŠ¨ç”» UpdateListenerï¼Œåœ¨ onAnimationUpdate çš„æ—¶å€™åŠ¨æ€è®¡ç®—å¸ƒå±€ä»è€Œå®ç°æ»‘åŠ¨åŠ¨ç”»,è¿™é‡Œæ‹¿ LinearSmoothScroller ä¸¾ä¾‹:</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">smoothScrollToPosition</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    recyclerView: <span class="type">RecyclerView</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    state: <span class="type">RecyclerView</span>.<span class="type">State</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    position: <span class="type">Int</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (position &gt;= itemCount || position &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> scroller: LinearSmoothScroller = <span class="keyword">object</span> : LinearSmoothScroller(recyclerView.context) &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è¿™ä¸ªæ–¹æ³•ç”¨äºè®¡ç®—æ»šåŠ¨åˆ°ç›®æ ‡ä½ç½®æ‰€éœ€çš„æ»šåŠ¨å‘é‡ã€‚æ»šåŠ¨å‘é‡æ˜¯ä¸€ä¸ªäºŒç»´å‘é‡ï¼ŒåŒ…å«æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šçš„æ»šåŠ¨è·ç¦»</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> targetPosition æ»‘åŠ¨çš„ç›®æ ‡ä½ç½®</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span>  è¿”å›ä¸€ä¸ª PointF å¯¹è±¡ï¼Œè¡¨ç¤ºæ»šåŠ¨å‘é‡ã€‚</span></span><br><span class="line"><span class="comment">         *              PointF.x è¡¨ç¤ºæ°´å¹³æ–¹å‘ä¸Šçš„æ»šåŠ¨è·ç¦»ï¼Œ</span></span><br><span class="line"><span class="comment">         *              PointF.y è¡¨ç¤ºå‚ç›´æ–¹å‘ä¸Šçš„æ»šåŠ¨è·ç¦»</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">computeScrollVectorForPosition</span><span class="params">(targetPosition: <span class="type">Int</span>)</span></span>: PointF &#123;</span><br><span class="line">            <span class="comment">// æŸ¥æ‰¾åˆ°å±å¹•é‡Œæ˜¾ç¤ºçš„ç¬¬ 1 ä¸ªå…ƒç´ ä¸</span></span><br><span class="line">            <span class="keyword">val</span> firstChildPos = getPosition(getChildAt(<span class="number">0</span>)!!)</span><br><span class="line">            <span class="keyword">val</span> direction = <span class="keyword">if</span> (targetPosition &lt; firstChildPos) -<span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">            <span class="comment">// x å·¦å³æ»‘åŠ¨ï¼Œç”±äºæˆ‘ä»¬åªå®ç°äº†å‚ç›´çš„æ»‘åŠ¨ï¼Œæ‰€ä»¥ xæ–¹å‘ä¸º0å³å¯</span></span><br><span class="line">            <span class="comment">// æ•´æ•°ä»£è¡¨æ­£å‘ç§»åŠ¨ï¼Œè´Ÿæ•°ä»£è¡¨åå‘ç§»åŠ¨ï¼Œè¿™é‡Œçš„æ•°å€¼å¤§å°ä¸é‡è¦ï¼Œæºç é‡Œé¢æœ€ç»ˆéƒ½ä¼š normalize å½’ä¸€åŒ–å¤„ç†</span></span><br><span class="line">            <span class="keyword">return</span> PointF(<span class="number">0f</span>, direction.toFloat())</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è®¡ç®—æ¯åƒç´ é€Ÿåº¦</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> displayMetrics</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> è¿”å›æ¯ä¸€åƒç´ çš„è€—æ—¶ï¼Œå•ä½msï¼Œå‡è®¾è¿”å›å€¼æ˜¯1.0 ä»£è¡¨ç€ï¼š1ms å†…ä¼šæ»‘åŠ¨ 1åƒç´ ï¼Œ1sä¼šæ»‘åŠ¨1000åƒç´ </span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">calculateSpeedPerPixel</span><span class="params">(displayMetrics: <span class="type">DisplayMetrics</span>?)</span></span>: <span class="built_in">Float</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.calculateSpeedPerPixel(displayMetrics)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ»‘åŠ¨é€Ÿåº¦çš„æ’å€¼ï¼ˆå®ç°æ»‘åŠ¨é€Ÿåº¦éšç€æ»‘åŠ¨æ—¶é—´çš„å˜åŒ–ï¼‰</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> dx</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">calculateTimeForDeceleration</span><span class="params">(dx: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.calculateTimeForDeceleration(dx)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¾ˆå¤šæ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼Œä¸å†ä¸€ä¸€åˆ—ä¸¾</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    scroller.targetPosition = position</span><br><span class="line">    <span class="comment">// æ‰§è¡Œé»˜è®¤åŠ¨ç”»çš„é€»è¾‘</span></span><br><span class="line">    startSmoothScroll(scroller)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåœ¨æ‰‹æœºä¸Šèƒ½çœ‹åˆ°è¿™æ ·çš„æ•ˆæœï¼šç‚¹å‡» smoothScrollTo30 å°†ä¼šæœ‰ä¸ªåŠ¨ç”»æ•ˆæœæ»‘åŠ¨åˆ°ç¬¬30ä¸ªä½ç½®ã€‚</p>
<img src="https://cdn.julis.wang/blog/img/layoutmanager_gradually_7.gif?imageView2/2/w/300">
<p>ä»¥ä¸ŠåŸºæœ¬ä¸Šä¸€ä¸ªè‡ªå®šä¹‰ LayoutManager çš„é›å½¢å°±å·²ç»å®Œæˆäº†ï¼Œè™½ç„¶åªå®ç°äº†ä¸€ä¸ªæ–¹å‘çš„æ»‘åŠ¨ï¼Œä½†æ˜¯å…¶åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå‰©ä¸‹çš„å°±æ˜¯å„ç§ç»†èŠ‚çš„æ‰“ç£¨äº†ï¼Œå¯ä»¥åŠ å„ç§è‡ªå·±æƒ³è¦çš„æ•ˆæœï¼Œæ¯”å¦‚ï¼šæŒ‡å®šä½ç½® æ”¾å¤§ä¸€å®šçš„ç³»æ•°ï¼Œæˆ–è€…æ›´ç‚«é…·çš„æ»‘åŠ¨åŠ¨ç”»â€¦</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦æ•´ç†äº†è‡ªå®šä¹‰ LayoutManager çš„å¿…è¦å…ƒç´ ï¼Œä»¥åŠå…¶æ ¸å¿ƒæ–¹æ³• scrollHorizontallyBy/scrollVerticallyByã€onLayoutChildren çš„ä½œç”¨ä¸è°ƒç”¨æ—¶æœºï¼Œæ¥ä¸‹å¯¹å®ç°ä¸€ä¸ªç®€å•çš„ LinearLayoutManger è¿›è¡Œé€»è¾‘æ‹†è§£ï¼Œä»æœ€ç®€å•çš„ä¸æ»‘åŠ¨å›æ”¶å’Œå¡«å……ä»¥åŠä¸å«æ»‘åŠ¨è¾¹ç•Œæ£€æµ‹ï¼Œåˆ°æœ€ç»ˆä¸€ä¸ªå…·å¤‡åŸºæœ¬åŠŸèƒ½çš„ LayoutManger</p>
<p>æºç ï¼š<a href="https://github.com/VomPom/LayoutManagerGradually">https://github.com/VomPom/LayoutManagerGradually</a></p>
<p>å‚è€ƒï¼š</p>
<p><a href="https://juejin.cn/post/6870770285247725581?searchId=202310181005138A6D82B1DEE9C47A9797#heading-23">ã€Šçœ‹å®Œè¿™ç¯‡æ–‡ç« ä½ è¿˜ä¸ä¼šè‡ªå®šä¹‰LayoutManagerï¼Œæˆ‘åƒXï¼ã€‹</a></p>
<p><a href="https://github.com/MycroftWong/FlowLayoutManager/blob/master/LayoutManager%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%9E%E8%B7%B5.md">ã€Š/LayoutManageråˆ†æä¸å®è·µã€‹</a></p>
<p><a href="https://wiresareobsolete.com/2014/09/building-a-recyclerview-layoutmanager-part-1/">Building a RecyclerView LayoutManager â€“ Part 1</a></p>
</div><div id="donate"><link rel="stylesheet" type="text/css" href="/css/donate.css?v=1.0.0"><script type="text/javascript" src="/js/donate.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><a class="pos-f tr3" id="github" href="https://github.com/Kaiyuan/donate-page" target="_blank" title="Github"></a><div id="DonateText">Donate</div><ul class="list pos-f" id="donateBox"><li id="AliPay" qr="https://cdn.julis.wang/blog/img/ali_pay.jpeg"></li><li id="WeChat" qr="https://cdn.julis.wang/blog/img/wechat_pay.png"></li></ul><div class="pos-f left-100" id="QRBox"><div id="MainBox"></div></div></div><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/technology/" rel="tag">æŠ€æœ¯æ–‡ç« </a></li></ul></div><div class="post-nav"><a class="pre" href="/2024/03/07/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89FFmpeg-Filter/">å®ç°ä¸€ä¸ªè‡ªå®šä¹‰ FFmpeg Filter</a><a class="next" href="/2023/09/30/Android-J2V8-%E5%AE%9E%E8%B7%B5/">Android åŸºäº J2V8 è¿è¡Œ JavasScript  å®è·µ</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="å…³äº"><img class="nofancybox" src="/img/avatar.png"/></a><p>For a better life.</p><a class="info-icon" href="mailto:admin@domain.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/vompom" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://www.douban.com/people/vompom/" title="è±†ç“£" target="_blank" style="margin-inline:5px"> <i class="fa fa-vimeo-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">æ€è€ƒæ€»ç»“</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/technology/">æŠ€æœ¯æ–‡ç« </a><span class="category-list-count">42</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">ç”Ÿæ´»æ„Ÿæƒ³</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6/">ç®—æ³•ç ”ç©¶</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/movie/">è¯»ä¹¦ç”µå½±</a><span class="category-list-count">6</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/travel/" style="font-size: 15px;">æ—…è¡Œ</a> <a href="/tags/zhihu/" style="font-size: 15px;">çŸ¥ä¹</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/FFmpeg/" style="font-size: 15px;">FFmpeg</a> <a href="/tags/MediaCodec/" style="font-size: 15px;">MediaCodec</a> <a href="/tags/plugins/" style="font-size: 15px;">æ’ä»¶åŒ–</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/%E9%80%86%E5%90%91/" style="font-size: 15px;">é€†å‘</a> <a href="/tags/Android/" style="font-size: 15px;">å®‰å“</a> <a href="/tags/KMP/" style="font-size: 15px;">KMP</a> <a href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/" style="font-size: 15px;">éŸ³è§†é¢‘</a> <a href="/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/tags/Http/" style="font-size: 15px;">Http</a> <a href="/tags/Https/" style="font-size: 15px;">Https</a> <a href="/tags/JNI/" style="font-size: 15px;">JNI</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 15px;">æ•°å­¦</a> <a href="/tags/java/" style="font-size: 15px;">Java</a> <a href="/tags/mmap/" style="font-size: 15px;">mmap</a> <a href="/tags/koin/" style="font-size: 15px;">koin</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">ç½‘ç»œ</a> <a href="/tags/Unity/" style="font-size: 15px;">Unity</a> <a href="/tags/life/" style="font-size: 15px;">ç”Ÿæ´»</a> <a href="/tags/%E8%AF%BB%E4%B9%A6/" style="font-size: 15px;">è¯»ä¹¦</a> <a href="/tags/thinking/" style="font-size: 15px;">çœ</a> <a href="/tags/%E6%8F%92%E4%BB%B6/" style="font-size: 15px;">æ’ä»¶</a> <a href="/tags/%E5%A4%A7%E5%AD%A6/" style="font-size: 15px;">å¤§å­¦</a> <a href="/tags/algorithm/" style="font-size: 15px;">ç®—æ³•</a> <a href="/tags/UTF-8/" style="font-size: 15px;">UTF-8</a> <a href="/tags/design/" style="font-size: 15px;">è®¾è®¡æ¨¡å¼</a> <a href="/tags/SDK/" style="font-size: 15px;">SDK</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 15px;">å·¥å…·</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/technology/" style="font-size: 15px;">æŠ€æœ¯æ–‡ç« </a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15px;">å‰ç«¯</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 15px;">é¢è¯•</a> <a href="/tags/%E8%AF%97%E6%AD%8C/" style="font-size: 15px;">è¯—æ­Œ</a> <a href="/tags/OpenGL/" style="font-size: 15px;">OpenGL</a> <a href="/tags/middle/" style="font-size: 15px;">é«˜ä¸­</a> <a href="/tags/%E9%B8%BF%E8%92%99/" style="font-size: 15px;">é¸¿è’™</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2026/02/04/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A5%BD%E7%94%A8%E7%9A%84SDK/">å¦‚ä½•æ„å»ºä¸€ä¸ªå¥½ç”¨çš„SDK</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/11/04/JPEG%E5%8E%8B%E7%BC%A9%E4%B9%8BDCT%E7%A6%BB%E6%95%A3%E4%BD%99%E5%BC%A6%E5%8F%98%E6%8D%A2/">JPEGå‹ç¼©ä¹‹DCTç¦»æ•£ä½™å¼¦å˜æ¢</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/09/15/H264%E7%A0%81%E6%B5%81%E7%BB%93%E6%9E%84%E7%90%86%E8%A7%A3%E6%95%B4%E7%90%86/">H264ç æµç»“æ„ç†è§£æ•´ç†</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/08/25/Koin-%E6%BA%90%E7%A0%81%E7%90%86%E8%A7%A3%E7%9B%B8%E5%85%B3/">æ‰‹å†™ä¸€ä¸ªç²¾ç®€ç‰ˆKoinï¼šæ·±å…¥ç†è§£ä¾èµ–æ³¨å…¥æ ¸å¿ƒåŸç†</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/07/28/Compose-Multiplatform-%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%8D%9A%E5%AE%A2%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/">[Compose Multiplatform]è·¨å¹³å°åšå®¢åº”ç”¨å®è·µ</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/05/16/%E9%B8%BF%E8%92%99-%E5%86%99%E4%BA%86%E4%B8%AA%E5%9F%BA%E4%BA%8EHexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E9%B8%BF%E8%92%99App/">[é¸¿è’™]å†™äº†ä¸ªåŸºäºHexoåšå®¢çš„é¸¿è’™App</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/03/30/KV-%E5%AD%98%E5%82%A8%E4%B9%8Bmmkv/">KV-å­˜å‚¨ä¹‹mmkv</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/03/17/Learn-from-RetroFit/">RetroFit2 æºç å­¦ä¹ ç›¸å…³</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/02/24/Android%E5%B1%8F%E5%B9%95%E5%88%B7%E6%96%B0%E6%9C%BA%E5%88%B6/">Androidå±å¹•åˆ·æ–°æœºåˆ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/11/10/%E5%85%B3%E4%BA%8E-pthread-key-t-%E5%AF%BC%E8%87%B4%E7%9A%84-Android-Crash-%E7%9A%84%E6%8E%A2%E7%B4%A2/">å…³äº pthread_key_t å¯¼è‡´çš„ Android Crash çš„æ¢ç´¢</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://k.julis.wang" title="Knowledge Precipitation" target="_blank">Knowledge Precipitation</a><ul></ul><a href="https://github.com/VomPom" title="Github" target="_blank">Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2026 <a href="/." rel="nofollow">è½å¶æŒ½æ­Œ.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.<p></a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>